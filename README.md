# CI прежде всего практика, а не инструменты
Доклад на [Инфостарт 2021](https://event.infostart.ru/2021/) "CI прежде всего практика, а не инструменты"

## Знакомство

Я-кать говорят не хорошо. А о себе в третьем лице еще хуже. Ну а раз так, значит давайте коротко о том где работаю и кем.
Работаю в небольшой компании ПрогТехБизнес (Уфа), являюсь ее основателем и руководителем со дня основания и до сих пор. Компания действительно небольшая, и немного специфическая. Мы никогда не работали на широкий рынок, не рекламировались и в общем то ведем достаточно тихий образ существования. С клиентами работаем по долгу и специализируемся на создании продуктов для конкретного заказчика. И обычно, это либо целиковые подсистемы, либо уже конфигурации.

С учетом такого подхода, мы никогда не были типичными франчайзи. А еще суть такая, кто никаких источников дохода дополнительных кроме созданных нами решений - у нас нет. Даже то, что мы делали, до коробок мы не довели. Потому что были увлечены развитием дальше. Это все я рассказываю, чтобы вы понимали: проблемы о которых я буду говорить далее, они и не проблемы вовсе для крупных компаний, у которых источники доходов диверсифицированы. И я ни в коем случае им не завидую, я наоборот с благодарностью отношусь представителям таких компаний, которые выходят и делятся с нами своими знаниями. Другое дело, как правило их подход не работает для небольших команд. Увы... но обо всем по порядку.

## История "как мы к CI шли" и почему мы поняли, что ничего не поняли

### Программисты которые делятся

Был 2020-й год, еще не все сидели по домам, а я готовился в докладу на [Infostart Meetup Kazan](https://infostart.ru/events/1152235/).

> картинка с гиперссылкой на доклад про Slack и что-нибудь еще

Все шло хорошо, переписывал код из нашей разработки в библиотечный вариант, не стыдный для демонстрации. А примерно за неделю до выступления, я вдруг по глупости ломаю SQL базу данных. И все бы ничего, но ломаю ее знатно, как говорится "с концами". Долго ли умеючи.

` Программисты делятся на два типа: кто еще не использует систему контроля версий и кто уже использует. `

Здесь стоит сказать, что использование хранилища для нас было привычным делом еще с первой крупной разработки в 2010-м году. Я сам всегда требовал и контролировал, чтобы ничего не проходило мимо хранилища. К марту 2020-го, на большинстве разработок у нас была система распределенных хранилищ. Все разработки у клиентов находились на поддержке, мы делали сборки, задачи вели в собственной системе учета и контроля разработок.

> картинка со схемой хранилищ как рекомендует 1С + можно из документации взять

Но разве будешь заморачиваться для pet-проекта такой ерундой? Будешь, еще как. Все проекты, которые я вел и веду (в том числе в свободном доступе на IS) они все имеют хранилища, ведется учет задач и по необходимости есть сборки (поставки), какая-то документация и т.д. Но именно здесь, что-то пошло не так. Я просто создал базу, просто начал делать, неделю почти безостановочно и с минимальным отвлечением кодил и все потерял. В буквальном смысле все. Более того, я поломал часть кода в основной системе (благо восстановить в старый вариант было не трудно). И как результат, я действительно планировал сделать хорошую автономную библиотеку, для интеграции со Slack. Но... как оказалось, потерять код - это было только начало.

Потом я потратил пару дней на попытку восстановить наработки. Все было тщетно. И буквально за несколько дней до выступления, я понял, ничего не выйдет. И восстановил минимально достаточную кодовую базу, доделал демонстрации и все убрал с мыслями "доделаю после выступления". Я просто еще не знал что будет потом. Да и поездка в Казань оказалась настолько воодушевляющей, что решено было - такого больше не повторится. Хранилища наше все...

`Ага... наше... все... в 2020-м то году. Самому сейчас н6е смешно? А ведь когда-то были времена когда ты внимательно следил за всем, чем занималась Серебрянная пуля, читал все что связано с Git, сборками и прочим. Но бежать и зарабатывать сегодня, чтобы было на что развивать компанию - проще чем думать о том, что технологически ты отстаешь. Делать деньги, когда есть клиенты - всегда легко... находить силы меняться - практически невозможно.`
### Стоять нельзя меняться - где здесь запятая?

Вскоре после выступления в Казани случилось то, что каждый знает. Все сели на "само" изоляцию. А я столкнулся с несколькими проблемами, команда в офисе и команда по домам - две разные команды. То, что хорошо работало тут, перестало работать или стало прилично сбоить. А еще, лично у меня не стало работы. То есть не совсем так, сложно остаться без работы, когда ты  руководитель, поэтому уточню: мне лично нечего было кодить. Все было распределено внутри команды. А я вдруг оказался без работы. Я прямо каждый день стал ощущать нарастание проблем.

Но начнем с хранилищ. Распределенные хранилища - это хорошо, когда вы приходите в офис и работаете, или когда у вас ноутбук и все на нем. Но когда все сели по домамам, я вдруг осознал, что либо РДП, либо компы увозим всем по домам? Сборка в основное хранилище = перенеси со своего домашнего на сервер в офисе. А к тому же, такой небольшой адок по передаче работ... в общем, может в команде никто ничего и не заметил, но я лично на себе стал ощущать, как привычная схема работы рассыпается.

Самое худшее, что вы можете сделать когда ваш бизнес идет ну если не ко дну, то выбрал четко данное направление - это пойти учится. Вот я это и сделал. Записался на курсы Infostart по Devops и сидел ждал. Ровно полдня, а потом проснулась совесть и я начал изучать Git самостоятельно. Перечитал все статьи на IS, пересмотрел все выступления на данную тему. И когда я подумал, что все понял... я стал менять в компании хранилища на Git. Здесь мы немного перепрыгнем мой длинный рассказ. Я похлеще Зака Снайдера могу хронометраж растягивать. Но суть такая, что к началу курсов с Git у меня проблем не было, и для внедрения в компании все было готово, статьи, уроки, доп. информация - все было расписано в базе знаний. Прошли курсы (к слову большое спасибо команде IS и лично Артуру Аюханову за данный курс и его неоценимую поддержку в тот момент). И тут я понял... серебрянной пули не случилось. Вот эти вот все Gitlab-ы, Jenkins-ы, тесты, статистические анализаторы - они не изменят мне работу, это инструменты. А если ты забиваешь шуруп - то хоть микроскопом, толку мало. Простой молоток тут даже лучше подойдет.

На Git вместо хранилищ мы перешли, у нас даже есть какие-то элементы CI и даже что-то из CD. Так что в этой сказке все неплохо. Плохо все в другом, в головах.

* [Почему конфликты в Git обсуждают всем миром, а сравнение/объединение в 1С это нормально?](docs/PART_1.md)
* [Программист без интернета - это уже CI](docs/PART_2.md)
* [Перестаньте рекомендовать Gitflow](docs/PART_3.md)
* [Простой тест, есть у вас CI или нет](docs/PART_4.md)

<hr>

## Полезные ссылки

* https://www.scaledagileframework.com/continuous-integration/
* https://services.google.com/fh/files/misc/state-of-devops-2019.pdf
* https://assets.thoughtworks.com/assets/technology-radar-vol-24-en.pdf